"use strict";(self.webpackChunkgame=self.webpackChunkgame||[]).push([[479],{7707:function(t,e,n){n.r(e),n.d(e,{default:function(){return U}});var r=n(7313),s=n(5982),a=n(4595),i=n(3953),l=n(6435),c=n(6417);var o=function(t){var e=t.id,n=t.className,r=t.style,s=t.onClick,a=void 0!==e?(0,l.e3)(e):0;return(0,c.jsx)("div",{className:"uno uno-".concat(a).concat(n?" ".concat(n):""),style:r,onClick:s})};function u(t){var e=t.id,n=t.large,r=t.className;return(0,c.jsx)("div",{className:r,style:{width:n?34:26,height:n?53:40},children:(0,c.jsx)(o,{id:e,style:{transform:n?"scale(0.4)":"scale(0.3)"}})})}var d=r.memo(u),f=n(1413),m=n(885),h=n(2982);function x(t){var e=t.ids,n=t.height,s=void 0===n?132:n,a=t.className,i=t.selected,l=t.setSelected,u=t.style;(0,r.useEffect)((function(){l(null)}),[e.length]);var d=41*s/132,m=58*s/132;return(0,c.jsx)("div",{className:"uno-list".concat(a?" ".concat(a):""),style:(0,f.Z)({height:s+d},u),children:e.map((function(t,e){return(0,c.jsx)(o,{id:t,style:{left:e*m,top:i===t?0:d,transform:"scale(".concat(s/132,")")},onClick:function(){l((function(e){return e===t?null:t}))}},t)}))})}x.defaultProps={height:132};var p=x,v=n(6350);var j=function(t){var e=t.disabledText,n=t.onClick,r=t.children,s=t.primary,i=t.className,l=!1!==e,o="string"===typeof e?e:"";return(0,c.jsxs)("div",{className:"relative",children:[(0,c.jsx)("div",{className:"uno-disabled-reason absolute text-black text-sm",children:o},(new Date).getTime()),(0,c.jsx)(a.Z,{disabled:l,onClick:n,primary:s,className:i,children:r})]})},g=n(4420),y=n(3366);function C(t,e,n){var r=(0,h.Z)(t.lastCard);r[0]=n;var s=!1;if(1===(0,l.Kh)(t,e.position)){var a=(0,l.YY)(t);if(r[e.position]=127-a.length,a.length===e.playerList.length-2){s=!0;var i=r.slice(1).findIndex((function(t){return t<=l.sn.Empty}));i>=0&&(r[i+1]=l.sn.Pass)}}else r[e.position]=n;var c=(0,h.Z)(t.cardList);return c[n]=0,{gameEnd:s,lastCard:r,cardList:c}}var N=function(t){var e=t.room,n=t.game,i=t.className,o=t.currentColor,u=t.currentDirection,d=t.currentNumber,x=t.currentPlus,N=t.isLeadCard,L=t.topCard,Z=t.version,k=t.send,w=(0,r.useState)(null),b=(0,m.Z)(w,2),U=b[0],V=b[1],E=(0,r.useMemo)((function(){return n.cardList.map((function(t,n){return t===e.position?n:-1})).filter((function(t){return t>=0}))}),[Z]),P=(15&n.state)===e.position,z=(0,r.useMemo)((function(){return 0===(4096&n.state)&&!P&&0!==n.state?n.cardList.findIndex((function(t,n){return t===e.position&&(0,l.e3)(n)===(0,l.e3)(L)})):-1}),[Z]),Y=function(t){k(s.Z.PlayerUpdateGameData,{data:v.N.encode(t).finish()})};(0,r.useEffect)((function(){z>=0&&V(z)}),[z,Z]);var M=(0,r.useMemo)((function(){if(null===U)return!0;if(!P)return!0;var t=(0,l.Vz)(U);if(N){if(13===d)return"\u5f15\u724c\u662f".concat(l.uj[13],"\uff0c\u5fc5\u987b\u4e0d\u51fa(\u64782\u5f20)");if(11===d)return"\u5f15\u724c\u662f".concat(l.uj[11],"\uff0c\u5fc5\u987b\u4e0d\u51fa")}if(x){if(13===d){if(13!==t&&15!==t)return"\u53ea\u80fd\u7528+2\u6216+4\u53e0\u52a0"}else if(t!==d)return"\u53ea\u80fd\u7528+4\u53e0\u52a0";return!1}return!(t>13)&&(null!==o&&(Math.floor(U/25)!==o&&(d>13?"\u53ea\u80fd\u51fa".concat(l.SV[o]):t!==d&&"\u53ea\u80fd\u51fa".concat(l.SV[o],"\u6216").concat(l.uj[d]))))}),[Z,U]);return(0,c.jsxs)("div",{className:i,children:[(0,l.uO)(n,e)<2||(0,l.YY)(n).includes(e.position)?(0,c.jsxs)("div",{className:"text-center text-xl px-2",children:[(0,c.jsx)("div",{children:(0,l.YY)(n).includes(e.position)?"\ud83c\udf89 \u606d\u559c\u4f60\u80dc\u5229\uff0c\u7b2c".concat((0,l.U2)(n,e.position),"\u540d\uff01"):"\u8fd9\u5c40\u8fd0\u6c14\u4e0d\u592a\u597d\u5662\uff0c\u4e0b\u6b21\u52a0\u6cb9\uff01"}),e.owner!==e.position&&(1===(0,l.U2)(n,e.position)||!(0,l.YY)(n).includes(e.position))&&(0,c.jsx)(a.Z,{className:"mt-2",small:!0,onClick:function(){return(0,y.Z)("\u5982\u679c\u5e0c\u671b\u91cd\u5f00\u4e00\u5c40\uff0c\u8bf7\u8ba9\u623f\u4e3b\u64cd\u4f5c\uff0c\u5148\u7ed3\u675f\u6e38\u620f\uff0c\u518d\u91cd\u65b0\u5f00\u59cb\u3002")},children:"\u5982\u4f55\u91cd\u5f00"})]}):(0,c.jsx)("div",{className:"flex flex-wrap justify-center items-center",style:{minHeight:48},children:0===n.state?(0,c.jsx)(a.Z,{primary:!0,className:"mx-2 mt-2",onClick:function(){var t,r=(0,h.Z)(n.lastCard),s=n.cardList.map((function(t,e){return 15===t&&(0,l.Vz)(e)<15?e:-1})).filter((function(t){return t>=0})),a=null!==(t=s[(0,g.M)(s.length)])&&void 0!==t?t:s[0];r[0]=a;var i=(0,h.Z)(n.cardList);i[a]=0;var c=(0,l.Vz)(a),o=6144|e.position|(12===c?64:0)|(13===c?128:0);Y({state:o,lastCard:r,cardList:i})},children:"\u6211\u5148\u51fa\u724c"}):P?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.Z,{className:"mx-2 mt-2",onClick:function(){var t=(0,h.Z)(n.lastCard);t[e.position]=l.sn.Pass;var r=(0,h.Z)(n.cardList),s=N&&11===d?0:x||1,a=n.cardList.filter((function(t){return 15===t})).length;a<s&&(r=r.map((function(t){return 15===t?e.position:0===t?15:t})),s-=a);for(var i=(0,g.T)(r.map((function(t,e){return 15===t?e:-1})).filter((function(t){return t>=0}))),c=0;c<s&&c<i.length;c++)r[i[c]]=e.position;var o=112&n.state|4096|(0,l.uU)(n,e,u);Y({state:o,lastCard:t,cardList:r})},children:N&&11===d?"\u4e0d\u51fa":"\u4e0d\u51fa(\u6478".concat(x||1,"\u5f20)")}),!M&&null!==U&&(0,l.Vz)(U)>13?(0,c.jsx)(c.Fragment,{children:l.SV.map((function(t,r){return(0,c.jsxs)(a.Z,{small:!0,className:"mx-2 mt-2",onClick:function(){if(null!==U){var t=C(n,e,U),s=t.lastCard,a=t.gameEnd,i=t.cardList,c=(15===(0,l.Vz)(U)?256+(1920&n.state)&1920:0)|64&n.state|r<<4;if(!a)if(15===(0,l.Vz)(U)&&256+(1920&n.state)===2048){c|=4096|(0,l.uU)(n,e,u,2);var o=(0,l.uU)(n,e,u);s[o]=l.sn.Pass;var d=32,f=i.filter((function(t){return 15===t})).length;f<d&&(i=i.map((function(t){return 15===t?o:0===t?15:t})),d-=f);for(var m=(0,g.T)(i.map((function(t,e){return 15===t?e:-1})).filter((function(t){return t>=0}))),h=0;h<d&&h<m.length;h++)i[m[h]]=o}else c|=(0,l.uU)(n,e,u);Y({state:c,lastCard:s,cardList:i})}},children:["\u51fa",t]},r)}))}):(0,c.jsx)(j,{primary:!0,disabledText:M,className:"mx-2 mt-2",onClick:function(){if(null!==U){var t=C(n,e,U),r=t.lastCard,s=t.cardList,a=t.gameEnd,i=(0,l.Vz)(U),c=13===i?128+(1920&n.state)&1920:0,o=u;12===i?(o=!o,64&n.state||(c|=64)):c|=64&n.state,a||(11===i||12===i&&2===(0,l.uO)(n,e)?(r[(0,l.uU)(n,e,o)]=l.sn.Pass,c|=(0,l.uU)(n,e,o,2)):c|=(0,l.uU)(n,e,o)),Y({state:c,lastCard:r,cardList:s})}},children:"\u51fa\u724c"})]}):z>=0&&(null!==U&&(0,l.Vz)(U)>13&&(0,l.e3)(U)===(0,l.e3)(z)?(0,c.jsxs)(c.Fragment,{children:[l.SV.map((function(t,r){return(0,c.jsxs)(a.Z,{small:!0,className:"mx-2 mt-2",onClick:function(){if(null!==U){var t=C(n,e,U),s=t.lastCard,a=t.cardList,i=t.gameEnd,c=(15===(0,l.Vz)(U)?256:0)|64&n.state|r<<4;if(!i){c|=(0,l.uU)(n,e,u);for(var o=15&n.state,d=0;d<e.playerList.length&&(s[o]=l.sn.Pass,(o=(0,l.uU)(n,(0,f.Z)((0,f.Z)({},e),{},{position:o}),u))!==e.position);d++);}Y({state:c,lastCard:s,cardList:a})}},children:["\u62a2\u51fa",t]},r)})),15===(0,l.Vz)(U)&&(0,c.jsx)("div",{className:"text-sm mt-2",children:"\u4e4b\u524d\u7d2f\u52a0\u724c\u6570\u4f1a\u6e05\u96f6"})]}):(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.Z,{primary:!0,disabled:null===U||(0,l.e3)(U)!==(0,l.e3)(z),className:"mx-2 mt-2",onClick:function(){if(null!==U){var t=C(n,e,U),r=t.lastCard,s=t.cardList,a=t.gameEnd,i=(0,l.Vz)(U),c=13===i?128:0,o=u;if(12===i?(o=!o,64&n.state||(c|=64)):c|=64&n.state,!a){11===i||12===i&&2===(0,l.uO)(n,e)?(r[(0,l.uU)(n,e,o)]=l.sn.Pass,c|=(0,l.uU)(n,e,o,2)):c|=(0,l.uU)(n,e,o);for(var d=15&n.state,m=0;m<e.playerList.length&&(r[d]=l.sn.Pass,(d=(0,l.uU)(n,(0,f.Z)((0,f.Z)({},e),{},{position:d}),o))!==e.position);m++);}Y({state:c,lastCard:r,cardList:s})}},children:"\u62a2\u51fa\u76f8\u540c\u724c"}),null!==U&&13===(0,l.Vz)(U)&&(0,l.e3)(U)===(0,l.e3)(z)&&(0,c.jsx)("div",{className:"text-sm mt-2",children:"\u4e4b\u524d\u7d2f\u52a0\u724c\u6570\u4f1a\u6e05\u96f6"})]}))}),(0,c.jsx)(p,{height:70,ids:E,selected:U,setSelected:V,className:"mt-3 mx-auto",style:{maxWidth:"100%",width:Math.ceil(70*(58*E.length+27)/132)}})]})},L=n(7992),Z=n(5385),k={height:84};var w=function(t){var e=t.room,n=t.game,r=t.position,s=t.opposite,a=t.send,i=(0,l.YY)(n);return(0,c.jsxs)("div",{className:"flex mt-2",children:[(0,c.jsx)(L.ZP,{className:s?"order-2":"",room:e,index:r-1,send:a,isTurn:(15&n.state)===r}),(0,c.jsxs)("div",{className:"flex-grow flex items-center order-1 text-center",style:k,children:[(0,c.jsxs)("div",{className:"".concat(s?"order-2":"order-1").concat(i.includes(r)?" invisible":""),children:[(0,c.jsx)(d,{className:"mx-1.5 mt-4"}),(0,c.jsx)(Z.Z,{n:(0,l.Kh)(n,r)})]}),(0,c.jsx)("div",{className:"flex flex-col flex-grow ".concat(s?"order-1":"order-2"),children:(0,c.jsx)("div",{className:"text-3xl ".concat(s?"ml-auto":"mr-auto").concat((15&n.state)===r?" animate-bounce":""),children:(15&n.state)===r?"\ud83e\udd14":n.lastCard[r]>l.sn.Empty?(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:"\ud83d\ude0e"}),i.length>1&&(0,c.jsx)("div",{className:"text-sm",children:"\u7b2c".concat((0,l.U2)(n,r))})]}):n.lastCard[r]===l.sn.Pass?"\ud83d\ude2d":n.lastCard[r]===l.sn.Empty?null:(0,c.jsx)(d,{id:n.lastCard[r]})})})]})]})},b={marginTop:42};var U=function(t){var e=t.room,n=t.game,r=t.send,u=v.N.decode(n.data),f=!!e.position,m=0===(64&u.state),h=0!==(2048&u.state),x=u.lastCard[0],p=x<100?Math.floor(x/25):h?null:u.state>>4&3,j=(0,l.Vz)(x),g=[13,15].includes(j)?(u.state>>7&15)<<1:0;return(0,i.N)([]),(0,c.jsxs)(c.Fragment,{children:[e.owner===e.position&&(0,c.jsx)("div",{className:"button-container",children:(0,c.jsx)("div",{className:"button-right",children:(0,c.jsx)(a.Z,{small:!0,onClick:function(){return(0,i.Z)("\u786e\u8ba4\u7ed3\u675f\u6e38\u620f\u5417\uff1f",(function(){return r(s.Z.OwnerExitGame)}))},children:"\u7ed3\u675f\u6e38\u620f"})})}),(0,c.jsxs)("div",{className:"flex justify-center items-center",children:[(0,c.jsxs)("div",{className:"flex items-center justify-center",children:["\u8fd8\u5269",(0,c.jsx)(Z.Z,{n:u.cardList.filter((function(t){return 15===t})).length}),"\u5f20"]}),(0,c.jsx)(d,{className:"ml-2 mr-4"}),0===u.state?(0,c.jsx)(d,{className:"mr-2 invisible"}):(0,c.jsx)(d,{id:x,className:"mr-2"}),(0,c.jsxs)("div",{className:"flex items-center justify-center",children:["\u5df2\u51fa",(0,c.jsx)(Z.Z,{n:u.cardList.filter((function(t){return 0===t})).length}),"\u5f20"]})]}),(0,c.jsxs)("div",{className:"flex justify-evenly items-center pt-2",children:[null!==g&&(0,c.jsxs)("div",{className:"flex items-center justify-center",children:["\u5df2\u7d2f\u52a0",(0,c.jsx)(Z.Z,{n:g}),"\u5f20"]}),(0,c.jsxs)("div",{children:["\u5f53\u524d",0===u.state||null===p&&j>=14?":\u4efb\u610f":null===p?l.uj[j]:j>=14?l.SV[p]:"".concat(l.SV[p]," ").concat(l.uj[j])]}),(0,c.jsxs)("div",{children:["\u65b9\u5411",m?"\u21aa\ufe0f":"\u21a9\ufe0f"]})]}),(0,c.jsxs)("div",{className:"flex-grow flex justify-around mt-2 relative",children:[(0,c.jsx)("div",{className:"w-36 flex flex-col",children:new Array(Math.floor((e.playerList.length+1)/2)).fill(0).map((function(t,n){return(0,c.jsx)(w,{position:n+1,room:e,game:u,send:r},n)}))}),(0,c.jsx)("div",{className:"w-36 flex flex-col",style:e.playerList.length%2?b:void 0,children:new Array(Math.floor(e.playerList.length/2)).fill(0).map((function(t,n){return(0,c.jsx)(w,{position:e.playerList.length-n,room:e,game:u,opposite:!0,send:r},n)}))}),0!==u.state&&(0,c.jsx)("div",{className:"absolute uno-last-card".concat(m?" uno-reverse":"").concat(null!==p?" uno-color-".concat(p):""),children:(0,c.jsx)(o,{id:x,style:{transform:"scale(0.6)",filter:"drop-shadow(0px 0px 2px gray)"}})})]}),f&&(0,c.jsx)(N,{send:r,room:e,game:u,version:n.version,currentColor:p,currentNumber:j,currentPlus:g,currentDirection:m,isLeadCard:h,topCard:x})]})}},715:function(t,e,n){n.r(e);var r=n(7313),s=n(714),a=n(6435),i=n(6350);function l(){return(0,r.useMemo)((function(){(0,s.Te)((function(t){return i.N.encode((0,a.Lq)(t)).finish()}))}),[]),null}e.default=r.memo(l)},3298:function(t,e,n){n.r(e);n(7313);var r=n(5109),s=n(8016),a=n(6417);e.default=function(t){var e=t.room,n=t.game,i=t.send;return(0,a.jsx)(r.Z,{room:e,game:n,send:i,children:(0,a.jsx)(s.Z,{room:e,send:i,options:[2,3,4,5,6,7,8,9,10]})})}},6350:function(t,e,n){n.d(e,{N:function(){return c}});var r=n(7710),s=r.Reader,a=r.Writer,i=r.util,l=r.roots.default||(r.roots.default={}),c=l.UNOGameData=function(){function t(t){if(this.lastCard=[],this.cardList=[],t)for(var e=Object.keys(t),n=0;n<e.length;++n)null!=t[e[n]]&&(this[e[n]]=t[e[n]])}return t.prototype.state=0,t.prototype.lastCard=i.emptyArray,t.prototype.cardList=i.emptyArray,t.encode=function(t,e){if(e||(e=a.create()),null!=t.state&&Object.hasOwnProperty.call(t,"state")&&e.uint32(8).uint32(t.state),null!=t.lastCard&&t.lastCard.length){e.uint32(18).fork();for(var n=0;n<t.lastCard.length;++n)e.uint32(t.lastCard[n]);e.ldelim()}if(null!=t.cardList&&t.cardList.length){e.uint32(26).fork();for(n=0;n<t.cardList.length;++n)e.uint32(t.cardList[n]);e.ldelim()}return e},t.decode=function(t,e){t instanceof s||(t=s.create(t));for(var n=void 0===e?t.len:t.pos+e,r=new l.UNOGameData;t.pos<n;){var a=t.uint32();switch(a>>>3){case 1:r.state=t.uint32();break;case 2:if(r.lastCard&&r.lastCard.length||(r.lastCard=[]),2===(7&a))for(var i=t.uint32()+t.pos;t.pos<i;)r.lastCard.push(t.uint32());else r.lastCard.push(t.uint32());break;case 3:if(r.cardList&&r.cardList.length||(r.cardList=[]),2===(7&a))for(i=t.uint32()+t.pos;t.pos<i;)r.cardList.push(t.uint32());else r.cardList.push(t.uint32());break;default:t.skipType(7&a)}}return r},t}()},6435:function(t,e,n){n.d(e,{Kh:function(){return l},Lq:function(){return f},SV:function(){return s},U2:function(){return c},Vz:function(){return p},YY:function(){return o},e3:function(){return h},sn:function(){return i},uO:function(){return u},uU:function(){return d},uj:function(){return a}});var r=n(4420),s=["\ud83d\udd34\u7ea2","\ud83d\udfe1\u9ec4","\ud83d\udfe2\u7eff","\ud83d\udd35\u84dd"],a=["0\ufe0f\u20e3","1\ufe0f\u20e3","2\ufe0f\u20e3","3\ufe0f\u20e3","4\ufe0f\u20e3","5\ufe0f\u20e3","6\ufe0f\u20e3","7\ufe0f\u20e3","8\ufe0f\u20e3","9\ufe0f\u20e3","\u4efb\u610f\u6570","\ud83d\udeab","\ud83d\udd04","+2"],i={Empty:114,Pass:113};function l(t,e){return t.lastCard[e]>i.Empty?0:t.cardList.filter((function(t){return t===e})).length}function c(t,e){return 128-t.lastCard[e]}function o(t){return t.lastCard.slice(1).map((function(t,e){return t>i.Empty?e+1:-1})).filter((function(t){return t>0}))}function u(t,e){return e.playerList.length-o(t).length}function d(t,e,n){for(var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=0,a=e.position,i=o(t),l=1;l<=e.playerList.length+2&&(a=(n?e.position+l:e.position+e.playerList.length-l)%e.playerList.length||e.playerList.length,i.includes(a)||(s+=1)!==r);l++);return a}function f(t){var e=new Array(t.playerList.length+1).fill(i.Empty);e[0]=0;for(var n=new Array(108).fill(15),s=(0,r.T)(new Array(108).fill(0).map((function(t,e){return e}))),a=0;a<t.playerList.length;a++)for(var l=0;l<7;l++)n[s[7*a+l]]=a+1;return{state:0,lastCard:e,cardList:n}}var m=[10,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,11,11,12,12,13,13,23,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22,22,24,24,25,25,26,26,36,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,37,37,38,38,39,39,49,40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,50,50,51,51,52,52,53,53,53,53,54,54,54,54];function h(t){return m[t]}var x=[10,1,2,3,4,5,6,7,8,9,0,11,12,13,1,2,3,4,5,6,7,8,9,0,11,12,13,1,2,3,4,5,6,7,8,9,0,11,12,13,1,2,3,4,5,6,7,8,9,0,11,12,13,14,15];function p(t){var e=h(t);return x[e]}}}]);